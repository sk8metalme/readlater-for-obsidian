# ReadLater for Obsidian - 開発計画書

## プロジェクト目標
Webページの記事を効率的に保存し、Claude CLIによる翻訳・要約機能でObsidianに統合できるChrome拡張機能を開発する。

## 開発フェーズ

### Phase 1: MVP開発 (4-6週間)

#### Sprint 1: 基盤構築 (1週間)
**目標**: Chrome拡張機能の基本構造とコンテキストメニューの実装

**実装項目**:
1. **プロジェクト初期設定**
   - `manifest.json` (Manifest V3)
   - 基本的なフォルダ構造
   - `package.json` と依存関係
   
2. **コンテキストメニュー機能**
   - 右クリックメニューに「後で読む」追加
   - Service Worker実装
   - 基本的なメッセージング

3. **設定画面の基盤**
   - オプションページ (`options.html`)
   - 設定値の保存・読み込み機能

**成果物**:
- Chrome拡張機能として読み込み可能
- 右クリックメニューで「後で読む」選択可能
- 基本的な設定画面

#### Sprint 2: 記事抽出機能 (1週間)
**目標**: Webページから記事情報を自動抽出する機能

**実装項目**:
1. **DOM解析エンジン**
   - タイトル抽出 (`<title>`, `og:title`)
   - メインコンテンツ抽出
   - URL情報取得

2. **コンテンツサニタイゼーション**
   - 不要な要素の除去
   - テキストの整形
   - Markdown変換準備

3. **フォールバック機能**
   - 抽出失敗時の対応
   - エラーハンドリング

**成果物**:
- 一般的なWebサイトからの記事抽出
- 抽出結果の構造化データ
- エラー処理機能

#### Sprint 3: Claude CLI連携 (1.5週間)
**目標**: AI翻訳・要約機能の実装

**実装項目**:
1. **Claude CLI統合**
   - APIキー管理機能
   - CLI呼び出し機能
   - レスポンス処理

2. **翻訳機能**
   - 言語検出
   - 多言語→日本語翻訳
   - 翻訳品質の最適化

3. **要約機能**
   - 記事要約生成
   - Markdown形式出力
   - 構造化された要約

**成果物**:
- Claude CLI APIとの連携機能
- 高品質な翻訳機能
- 記事要約機能

#### Sprint 4: ファイル保存機能とUI最適化 (1週間)
**目標**: Markdownファイル保存機能とユーザビリティの向上

**実装項目**:
1. **ファイル保存機能**
   - Downloads APIによるMarkdownファイル保存
   - ユーザー指定フォルダへの保存
   - ファイル名生成ロジック（日付_タイトル.md）
   - 重複ファイル処理

2. **通知システム強化**
   - 成功/失敗通知の改善
   - 進捗インジケーター
   - 詳細なエラーメッセージ
   - 処理状況の可視化

3. **UI/UX最適化**
   - オプションページの改善
   - エラーハンドリングの強化
   - ユーザーフィードバックの改善
   - レスポンシブ対応

4. **Markdownテンプレート最適化**
   - フロントマターの充実
   - 構造化されたMarkdown出力
   - Obsidian連携の最適化

**成果物**:
- 完全なMarkdownファイル保存機能
- 強化された通知システム
- 改善されたUI/UX
- 完全なエンドツーエンドワークフロー

#### Sprint 5: テスト・改善 (0.5週間)
**目標**: 品質保証とユーザビリティ改善

**実装項目**:
1. **統合テスト**
   - エンドツーエンドテスト
   - 主要Webサイトでの動作確認
   - パフォーマンステスト

2. **UI/UX改善**
   - エラーメッセージの改善
   - 設定画面の使いやすさ向上
   - レスポンシブ対応

3. **ドキュメント作成**
   - README.md
   - インストール手順
   - 使用方法ガイド

**成果物**:
- テスト済みMVP版
- ユーザーマニュアル
- インストールパッケージ

### Phase 2: 機能拡張 (4-6週間) - 将来計画

#### 拡張機能候補:
1. **記事管理機能**
   - 保存済み記事一覧
   - 検索・フィルタリング
   - タグ管理

2. **翻訳サービス拡張**
   - 複数翻訳エンジン対応
   - 翻訳品質選択
   - 部分翻訳

3. **Obsidian連携強化**
   - テンプレート連携
   - 自動リンク生成
   - Daily Notes統合

## 技術設計

### アーキテクチャ
```
Chrome Extension (Manifest V3)
├── Service Worker (background.js)
├── Content Script (content.js)
├── Options Page (options.html/js)
└── Popup (popup.html/js) - 将来実装
```

### ファイル構成
```
readlater-for-obsidian/
├── manifest.json
├── src/
│   ├── background/
│   │   └── service-worker.js
│   ├── content/
│   │   └── content-script.js
│   ├── options/
│   │   ├── options.html
│   │   ├── options.js
│   │   └── options.css
│   ├── lib/
│   │   ├── article-extractor.js
│   │   ├── claude-api.js
│   │   ├── markdown-generator.js
│   │   └── file-saver.js
│   └── utils/
│       ├── dom-utils.js
│       ├── storage-utils.js
│       └── notification-utils.js
├── docs/
├── tests/
└── package.json
```

### 主要モジュール

#### 1. ArticleExtractor
- DOM解析による記事抽出
- メタデータ取得
- コンテンツサニタイゼーション

#### 2. ClaudeAPI
- Claude CLI呼び出し
- 翻訳・要約処理
- エラーハンドリング

#### 3. MarkdownGenerator
- テンプレート生成
- フロントマター作成
- ファイル名生成

#### 4. FileSaver
- Downloads API使用
- ファイル保存処理
- パス管理

## 品質保証

### テスト戦略
1. **ユニットテスト**: 各モジュールの単体テスト
2. **統合テスト**: Chrome拡張機能としての動作テスト
3. **E2Eテスト**: 実際のWebサイトでのワークフローテスト
4. **パフォーマンステスト**: 大容量記事での処理時間測定

### 品質基準
- **機能性**: 主要Webサイトで90%以上の成功率
- **パフォーマンス**: 30秒以内の処理完了
- **セキュリティ**: APIキーの暗号化保存
- **ユーザビリティ**: 直感的な操作とエラーメッセージ

## リスク管理

### 技術リスク
1. **Claude CLI API制限**: 代替手段の検討
2. **Manifest V3制約**: 最新仕様への対応
3. **ファイル保存制限**: Downloads APIの制約対応

### 対策
1. **API制限**: レート制限の実装とユーザー通知
2. **互換性**: Chrome最新版での継続テスト
3. **フォールバック**: 基本機能の保証

## 成功指標

### MVP完了基準
1. ✅ Chrome拡張機能として正常に動作
2. ✅ 主要Webサイト（10サイト以上）で記事抽出成功
3. ✅ Claude CLI連携で翻訳・要約実行
4. ✅ Markdownファイルの正常保存
5. ✅ エラーハンドリングとユーザー通知

### KPI
- **使用成功率**: 90%以上
- **処理時間**: 平均20秒以下
- **ユーザー満足度**: フィードバックベース

## 次のアクション
1. **Git branch作成**: feature/mvp-development
2. **プロジェクト構造初期化**: manifest.json、基本フォルダ
3. **Sprint 1開始**: コンテキストメニュー実装
